---
title: Устранение ошибок
layout: default
lang: ru
category: Устранение ошибок
order: 400
---

* This will become a table of contents (this text will be scraped).
{:toc}

Описание некоторых возможных ошибок и попытки их устранения.

## Ошибки после установки панели

### Ошибка 500

Причин у этой ошибки огромное количество, необходимо включить отображение 
дебаг сообщений чтобы выяснить некоторые подробности.

* Откройте файл `.env` (не `.env.example` и не любой другой файл c наличием env, а именно `.env`).
* Установите параметру `APP_DEBUG` значение `true`.
```
APP_DEBUG=true
```

* Попробуйте открыть страницу с панелью вновь, дожна появиться более подробная информация об ошибках
* Посмотрите логи панели. Они хранятся в `*.log` файлах в каталоге `storage/logs`, полный путь по умолчанию `/var/www/gameap/storage/logs`.
* С учётом появившейся информации попробуйте найти здесь информацию как это исправить, либо
добавляйтесь в [группу в Telegram](https://t.me/game_admin_panel) и попросите о помощи.
* Помощь также можно получить на [форуме](https://forum.gameap.ru).

### Ошибка 403

Это общая ошибка. Причин у неё может быть много.

Обычно подобная ошибка возникает в случаях, если неправильно настроены виртуальные хосты веб сервера, либо
нет прав на доступ к файлам панели.

#### Проверка привилегий

Проверьте права на каталог панели. По умолчанию `/var/www/gameap`.
У пользователя, от которого запущен веб сервер (обычно `www-data`) должен быть доступ к этому каталогу.

Если прав нет, то установите их
```
chown -R www-data:www-data /var/www/gameap
chmod 755 /var/www/gameap
```

> Обратите внимание, что не всегда веб сервер может быть запущен от пользователя
> `www-data`, иногда это может быть `nginx`, иногда `apache`.

#### Nginx
В Nginx ошибка выглядит обычно так

![](/images/errors/403_nginx.png)

* Посмотрите логи веб сервера в каталоге `/var/log/nginx`
* Проверьте настройки виртуальных хостов Nginx в каталоге `/etc/nginx/conf.d`

#### Apache
В Apache это выглядит примерно так

![](/images/errors/403_apache.png)

* Посмотрите логи веб сервера в каталоге `/var/log/apache2`.
* Проверьте настройки виртуальных хостов Apache в каталоге `/etc/apache2/sites-available`, либо в `/etc/apache2/sites-enabled`.

### Whoops, looks like something went wrong.

![](/images/errors/something_went_wrong.png)

Ошибка может возникать по разным причинам. Чтобы выяснить подробности, необходимо включить 
отображение подробностей.

Откройте файл `.env`, измените параметр `APP_DEBUG`:
```env
APP_DEBUG=true
```

После того, как вы включите отображение подробностей, сравнивайте ваши ошибки с тем, что перечислено ниже.

#### Генерация ключа

![](/images/errors/key_generate.png)

Эта проблема возникнет если вы забыли сгенерировать ключ. Перейдите в каталог с панелью и выполните команду:

```
php artisan key:generate --force
```

#### Миграция базы данных

![](/images/errors/db_migrate.png)

Эта проблема возникает, если вы забыли выполнить команду миграции базы данных после установки панели. Перейдите в каталог с панелью и выполните команду:

```
php artisan migrate --seed
```

#### Неправильные параметры базы данных

![](/images/errors/db_access_denied.png)

Проблема возникает, если в настройках указаны неверные параметры от базы данных (хост, логин или пароль). 
Откройте файл `.env` и проверьте параметры: `DB_HOST`, `DB_DATABASE`, `DB_USERNAME`, `DB_PASSWORD`.

Иногда для параметра `DB_HOST` вместо `127.0.0.1` должно быть указано `localhost` или наоборот.

## Ошибки запуска сервера

Больше подробностей о проблеме можно увидеть в логах. 
Перейдите на страницу **Администрирование** -> **GDaemon задания**, после этого откройте последнее задание на 
запуск игрового сервера.

Проверьте логи GameAP Daemon. Они хранятся на выделенном сервере в каталоге `/var/log/gameap-daemon`.

### Статус сервера отображается неверно

Иногда бывает, что сервер на самом деле запускается, но его статус в панели отображается как офлайн.
Читайте раздел [ошибки отображения статуса сервера](#ошибки-отображения-статуса-сервера)

### Не указана команда запуска игрового сервера

Эта ошибка возникает, когда команда запуска для игрового сервера пуста, её нужно указать.

Перейдите на страницу администрирование игровым сервером: **Администрирование** -> **Серверы** -> Выберите ваш игровой сервер.

Либо с главной страницы **Список серверов** -> Выберите ваш игровой сервер -> **Управление** -> **Администрирование**

Найдите поле **Команда запуска игрового сервера**, впишите туда команду запуска. Для Counter-Strike 1.6 команда будет 
примерно следующей:
```
./hlds_run -game cstrike +ip {ip} +port {port} +map {default_map} +maxplayers {maxplayers} +sys_ticrate {fps}
```

Более подробно о команде запуска читайте на странице [настройка игровых серверов](/ru/gameap_configure/game_servers.html#команда-запуска).
Вы можете задать команду запуска по умолчанию в [настройках модификации игрового сервера](/ru/gameap_configure/games.html#команды-запуска-по-умолчанию).

Иногда, после изменения настроек игрового сервера требуется перезапуск GameAP Daemon.

### Окно с информацией висит и не меняется долгое время

Обычно, запуск занимает менее 10 секунд. Если полоска статуса застыла на 10% или статус не меняется несколько минут,
то попробуйте запустить/перезапустить GameAP Daemon:
```
service gameap-daemon restart
```

Если перезапуск не помог, то возможно, что , GameAP Daemon по какой-то причине приостанавливает свою работу, посмотрите 
логи (Каталог `/var/log/gameap-daemon`).

Посмотрите раздел [ошибки GameAP Daemon](#ошибки-gameap-daemon), возможно там найдёте нужное вам решение.

### Server start task is already exists / Задача уже существует 

Ошибка возникает когда задача на запуск уже имеется. Есть два способа решить проблему: отменить задачу и проверить
работу GameAP Daemon.

Для отмены задачи перейдите на страницу **"GDaemon задания"**, найдите в списке вашу задача со статусом ожидает 
(waiting), нажмите на кнопку **"Просмотр"**, затем нажмите **"Отменить"**. После этого попробуйте запустить сервер ещё
раз.

Проверьте работу GameAP Daemon:
```shell
service gameap-daemon status
```

Если GameAP Daemon оффлайн, то запустите его:
```shell
service gameap-daemon start
```

Если GameAP Daemon онлайн, то выполните reload:
```shell
service gameap-daemon force-reload
```

## Ошибки отображения статуса сервера

### Несоответствие времени

Проблема связана с несоответствием времени на веб-сервере и на выделенном сервере, на котором находится игровой сервер.
Измените время и часовой пояс.


Изменение часовых поясов в Debian/Ubuntu осуществляется командой:
```bash
dpkg-reconfigure tzdata
```

### Кеширование в настройках веб-сервера

Отключите кеширование в настройках хоста веб сервера. Если включено кеширование, то веб-сервер будет отдавать
кешированную страницу с устарелой информацией.

Как это происходит? К примеру, вы открыли страницу управления сервером, сервер выключен, затем включили сервер,
но видите, что на странице по прежнему сервер отображается как офлайн. Это произошло потому, что веб-сервер "отдал" вам
старую страницу из кеша, на момент когда сервер был выключен.

Примеры конфигурации для хоста смотрите на странице
[настройка веб сервера](/ru/install.html#настройка-веб-сервера).

## Ошибки установки серверов

Игровые серверы могут не устанавливаться по разным причинам.

Чтобы установить причину, нужно посмотреть результат выполнения команды установки. В меню слева выберите
**"GDaemon задания"**, затем найдите в списке задание на установку и откройте. Посмотрите лог с результатом установки.

Вот некоторые причины ошибок при установке:
* [Нет источника для установки](/ru/troubleshooting.html#нет-источника)
* [Неправильно сформирован архив установки](/ru/troubleshooting.html#неправильно-сформирован-архив-установки)
* [Неправильно указан источник установки](/ru/troubleshooting.html#неправильно-указан-источник-установки)

### Нет источника

Эта ошибка возникает, когда панель не знает откуда устанавливать игровой сервер. Способов установки есть несколько:
* Установка через SteamCMD, должен быть указан Steam APP ID в настройках игры
* Установка из удалённого репозитория. Должен быть указан URL к ZIP или TAR архиву (RAR не поддерживается).
* Установка из локального репозитория. Должен быть указан путь папке с файлами будущего игрового сервера, либо путь к 
ZIP или TAR архиву (RAR не поддерживается). Сами файлы должны располагаться на выделенном сервере где запущен GameAP Daemon.

Для настройки источников перейдите на страницу **Администрирование** -> **Игры** -> выберите свою игры 
-> **Редактировать**, затем укажите один из источников.

### Неправильно сформирован архив установки

Архив должен содержать файлы будущего игрового сервера. Самая частая ошибка, когда игровые файлы
находятся во вложенном каталоге в архиве.

Посмотрите примеры. Ниже неправильно сформированный архив для игры GTA: San Andreas Multiplayer:

![](/images/errors/source_archive_wrong.jpg)

А вот так правильно:

![](/images/errors/source_archive_right.jpg)


### Неправильно указан источник установки

Если вы указываете локальный репозиторий, то проверьте,
существует ли каталог на выделенном сервере на котором запущен GameAP Daemon.

Если это URL к удалённому ресурсу, то проверьте доступен ли он по ссылке. При переходе по ссылке
файл должен начать скачивание. Ссылки к Yandex Disk, Google Drive и т.п. не поддерживаются.

### Failed to install via steamcmd

Иногда пользователи steamcmd сталкиваются с такой ошибкой посреди процесса загрузки/обновления дистрибутива, причины до конца не известны, но панель поддерживает работу с альтернативной системой загрузки "depot downloader". Для использования нужно заменить скрипт steamcmd.sh на альтернативный:

```
cd /srv/gameap/steamcmd
mv steamcmd.sh steamcmd.sh.orig
curl -O https://raw.githubusercontent.com/gameap/steamcmd-depotdownloader/main/steamcmd.sh
chmod 755 steamcmd.sh && chown gameap:gameap steamcmd.sh
```

## Ошибки GameAP Daemon

### Could not connect to host: x.x.x.x, port:31717(Error 0: )

Панель не смогла подключиться к GameAP Daemon.

Очень обширная ошибка, возникнуть может по разным причинам.
Обычно возникает когда GameAP Daemon не работает, не сконфигурирован или
не работает должным образом.

#### Игровые серверы устанавливаются, запускаются
GameAP Daemon работает, устанавливает серверы, запускает их, однако панель всё равно не может подключиться к GDaemon.
Попробуйте установить параметр `listen_ip` в конфигурации GameAP Daemon.

### Серверы запускаются, останавливаются, но консоль и файловый менеджер не работают

Причин этой проблемы может быть много

#### Закрыт порт GameAP Daemon

Возможно на выделенном сервере закрыт порт, на котором работает GameAP Daemon (по умолчанию 31717).

#### Неправильно указан хост в настройках GDaemon

Перейдите в настройки выделенного сервера 
**Администрирование** -> **Выделенные серверы** -> **Редактировать** -> **GDaemon**

В поле `GDdaemon хост` укажите другой IP или доменное имя.


### Перестала отображаться консоль игрового сервера

Спустя какое-то время перестала отображаться консоль игрового сервера.

Перезапустите GDaemon:
```bash
service gameap-daemon restart
```

### Перестал работать файловый менеджер в панели

Спустя какое-то время перестал работать файловый менеджер в панели управления.

Перезапустите GDaemon:
```bash
service gameap-daemon restart
```

### После перезагрузки выделенного сервера не запускается автоматически GameAP Daemon

Для Debian/Ubuntu выполните команду:
```bash
systemctl enable gameap-daemon
```

### Task complete with an error

Ошибка возникает при установке, запуске, перезапуске, остановке игрового сервера. Причин у этой ошибки
может быть множество.

Перейдите на страницу **Администрирование** -> **GDaemon задания**, после этого откройте последнее задание и посмотрите 
там подробности об ошибке.

Проверьте логи GameAP Daemon. Они хранятся на выделенном сервере в каталоге `/var/log/gameap-daemon`.

#### No source to install game

Ошибка возникает, если для игры нет источника по установке: не указан SteamID, не указан URL удалённого
репозитория, не указан путь локального репозитория.

Для настройки источников перейдите на страницу **Администрирование** -> **Игры** -> выберите свою игры 
-> **Редактировать**, затем укажите один из источников.

## Поиск причин

Возможно, здесь нет описания вашей проблемы, тогда вам необходимо найти дополнительную информацию о причинах в логах.

Логи GameAP Daemon хранятся в каталоге `/var/log/gameap-daemon` (Linux), 
`C:\gameap\daemon\logs` (Windows). Откройте файл `error.txt` и посмотрите содержимое, возможно там будет указана дополнительная информация,
которая поможет выяснить причину.

Чтобы посмотреть логи запуска, перезапуска, установки игрового сервера, то зайдите в панель и перейдите в **"GDaemon задания"**,
затем найдите в списке соответствующую запись вашей команде и откройте.